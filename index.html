<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>è–èª•ä¸Šæµ·ä¹‹æ—… 2025</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700;900&family=Noto+Sans+SC:wght@900&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        scheme1: { 
                            bg: '#0F172A',        
                            primary: '#FF7EE2',   
                            secondary: '#22D3EE', 
                            accent: '#FDE047',    
                            textMain: '#FFFFFF',
                            textSub: '#E2E8F0',
                            cardBg: 'rgba(255, 255, 255, 0.1)' 
                        }
                    },
                    fontFamily: { 
                        sans: ['Noto Sans TC', 'sans-serif'],
                        deco: ['Zen Maru Gothic', 'sans-serif'], 
                        heiti: ['Noto Sans SC', 'Heiti SC', 'SimHei', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        html, body {
            height: 100%;
            height: 100dvh;
            overflow: hidden;
            overscroll-behavior: none;
            background-color: #0F172A;
            color: #FFFFFF;
            /* é˜²æ­¢ iOS é•·æŒ‰é¸å–æ–‡å­— */
            -webkit-user-select: none;
            user-select: none;
        }
        
        #app {
            height: 100%;
            height: 100dvh;
            width: 100%;
            display: flex;
            justify-content: center;
        }

        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        .animate-fade-in { animation: fadeIn 0.4s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; }
        .animate-spin-slow { animation: spin 10s linear infinite; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .shanghai-bg {
            background-color: #0F172A;
            background-image: 
                linear-gradient(to bottom, rgba(30, 27, 75, 0.2), rgba(15, 23, 42, 0.85)),
                url('https://images.unsplash.com/photo-1548266652-99cf27701ced?q=80&w=2670&auto=format&fit=crop'); 
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.03); 
            backdrop-filter: blur(8px);             
            border: 1px solid rgba(255, 255, 255, 0.12); 
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        }
        
        .glass-nav {
            background: rgba(15, 23, 42, 0.85); 
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 -4px 30px rgba(0, 0, 0, 0.6);
        }

        .glass-header {
            background: rgba(15, 23, 42, 0.15); 
            backdrop-filter: blur(6px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .glass-deco {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .text-shadow-sm { text-shadow: 0 1px 3px rgba(0,0,0,0.6); }
        
        /* --- SortableJS é—œéµæ¨£å¼ --- */
        
        /* æ‹–æ›³æ™‚ï¼ŒåŸä½ç½®çš„ä½”ä½ç¬¦æ¨£å¼ */
        .sortable-ghost { 
            opacity: 0.1; 
            background: rgba(255, 255, 255, 0.05);
            border-radius: 0.75rem;
        }

        /* æ­£åœ¨è¢«æ‹–æ›³çš„é …ç›® (æ‡¸æµ®æ•ˆæœ) */
        .sortable-drag { 
            cursor: grabbing; 
            opacity: 1 !important;
            background: rgba(30, 41, 59, 0.95) !important; /* æ·±è‰²èƒŒæ™¯ç¢ºä¿çœ‹ä¸é€ */
            backdrop-filter: blur(10px);
            transform: scale(1.05) rotate(2deg); /* æ”¾å¤§ä¸¦ç¨å¾®å‚¾æ–œ */
            box-shadow: 
                0 20px 25px -5px rgba(0, 0, 0, 0.5), 
                0 8px 10px -6px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 126, 226, 0.5); /* Primary color border */
            z-index: 9999 !important; /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
            border-radius: 0.75rem;
        }
        
        /* éš±è—æ‹–æ›³æ™‚å¯èƒ½å‡ºç¾çš„è—è‰²é¸å–æ¡† */
        * { -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body>
    <div id="app" class="font-sans font-medium text-scheme1-textMain">
        <div class="w-full max-w-md h-full relative shadow-2xl flex flex-col overflow-hidden bg-transparent">
            
            <div class="absolute inset-0 z-0 shanghai-bg pointer-events-none"></div>

            <header class="glass-header text-white p-3 pt-5 pb-2 shadow-sm z-10 flex justify-between items-center relative flex-shrink-0">
                <div class="relative z-10 flex flex-col justify-center h-full w-full pl-2">
                    <h2 class="text-xs tracking-widest opacity-90 text-scheme1-secondary mb-0.5 font-sans font-bold uppercase drop-shadow-md">Wayne & Chloe | Shanghai 2025</h2>
                    <h1 class="text-2xl font-deco tracking-widest text-white drop-shadow-lg font-medium mt-0">
                        {{ myData.title }}
                    </h1>
                </div>
                <div class="w-9 h-9 glass-deco rounded-full flex items-center justify-center shadow-inner flex-shrink-0 mr-2 border border-white/30">
                    <i class="fa-solid fa-plane-up text-white animate-bounce text-xs drop-shadow-md"></i>
                </div>
            </header>

            <main class="flex-1 overflow-y-auto scrollbar-hide p-4 pb-24 space-y-5 relative z-10">
                
                <div v-if="currentTab === 'flight'" class="animate-fade-in space-y-4">
                    <h3 class="font-bold text-xl pl-3 border-l-4 border-scheme1-primary text-white text-shadow-sm font-deco tracking-wide">âœˆï¸ èˆªç­è³‡è¨Š</h3>
                    <div class="glass-card rounded-2xl p-4 relative overflow-hidden group">
                        <div class="absolute top-3 left-3 bg-scheme1-primary/20 border border-scheme1-primary/80 text-scheme1-primary text-xs px-2.5 py-0.5 rounded-full font-bold tracking-widest">å»ç¨‹ OUTBOUND</div>
                        <div class="mt-8 flex justify-between items-center mb-4">
                            <div class="text-center w-1/3"><div class="text-5xl font-black text-white tracking-tighter drop-shadow-lg font-heiti">{{ myData.flightOut.from }}</div><div class="text-sm text-scheme1-accent font-bold mt-1 tracking-wide">é¦™æ¸¯ T1</div></div>
                            <div class="flex-1 px-2 text-center flex flex-col items-center"><div class="text-xs text-scheme1-primary font-bold">{{ myData.flightOut.airline }}</div><i class="fa-solid fa-plane text-white text-xl block my-1 drop-shadow-md"></i><div class="border-b-2 border-dotted border-white/40 w-full h-1"></div><div class="text-xs text-scheme1-textSub mt-1 font-bold">{{ myData.flightOut.no }}</div></div>
                            <div class="text-center w-1/3"><div class="text-5xl font-black text-white tracking-tighter drop-shadow-lg font-heiti">{{ myData.flightOut.to }}</div><div class="text-sm text-scheme1-accent font-bold mt-1 tracking-wide">ä¸Šæµ·æµ¦æ± T1</div></div>
                        </div>
                        <div class="bg-white/5 rounded-xl p-3 flex justify-between items-start text-sm border border-white/20">
                            <div><span class="text-xs text-scheme1-textSub/80 font-bold block">Date</span>{{ myData.flightOut.date }}</div>
                            <div class="flex gap-4">
                                <div class="text-right"><span class="text-xs text-scheme1-textSub/80 font-bold block">Dep</span><span class="font-bold text-scheme1-primary text-xl">{{ myData.flightOut.dep }}</span></div>
                                <div class="text-right"><span class="text-xs text-scheme1-textSub/80 font-bold block">Arr</span><span class="font-bold text-scheme1-primary text-xl">{{ myData.flightOut.arr }}</span></div>
                            </div>
                        </div>
                    </div>
                    </div>

                <div v-if="currentTab === 'schedule'" class="animate-fade-in space-y-4">
                    
                    <div class="grid grid-cols-4 gap-2 px-1">
                        <button v-for="(day, index) in myData.days" :key="index" @click="currentDayIndex = index" 
                            :class="currentDayIndex === index ? 'bg-scheme1-primary/90 text-white shadow-[0_0_15px_rgba(255,126,226,0.6)] border-transparent scale-105' : 'glass-card text-white/80 border-white/20'"
                            class="py-2 rounded-xl flex flex-col items-center justify-center transition-all duration-300 backdrop-blur-sm h-full">
                            <div class="flex flex-col items-center leading-none text-white w-full gap-0.5">
                                <span class="text-[10px] uppercase tracking-wider font-bold opacity-80 mb-0.5">DAY {{ index + 1 }}</span>
                                <span class="text-3xl font-black drop-shadow-sm -my-1">{{ day.dayNum }}</span>
                                <span class="text-[10px] font-bold opacity-80 mt-0.5">{{ day.weekday }}</span>
                            </div>
                        </button>
                    </div>

                    <div>
                        <h3 class="font-bold text-lg mb-4 text-white flex items-center justify-between opacity-90 pl-1 text-shadow-sm">
                            <div><span class="text-scheme1-primary mr-2"><i class="fa-solid fa-calendar-day"></i></span>{{ myData.days[currentDayIndex].date }}</div>
                            <span v-if="!isDragging" class="text-[10px] bg-white/10 px-2 py-1 rounded text-gray-300"><i class="fa-solid fa-fingerprint mr-1"></i>é•·æŒ‰å¡ç‰‡æ‹–æ›³æ’åº</span>
                            <span v-else class="text-[10px] bg-scheme1-primary text-black px-2 py-1 rounded font-bold animate-pulse"><i class="fa-solid fa-arrows-up-down mr-1"></i>æ’åºä¸­...</span>
                        </h3>
                        
                        <div class="relative pl-4">
                            <div class="absolute left-[3.5px] top-2 bottom-0 w-[2px] bg-white/20 rounded-full"></div>
                            
                            <div ref="sortableList" class="space-y-3 pb-4">
                                <div v-for="(item, idx) in myData.days[currentDayIndex].events" :key="item.id" 
                                     class="relative group select-none transition-transform duration-200"
                                     :data-id="item.id">
                                    
                                    <div class="absolute -left-[17px] top-3 w-3 h-3 bg-scheme1-bg border-[3px] border-scheme1-primary rounded-full z-10 shadow-sm pointer-events-none"></div>
                                    
                                    <div class="glass-card rounded-xl p-0 transition-all duration-300 relative overflow-hidden z-0 active:scale-95">
                                        
                                        <div v-if="item.img" class="h-24 w-full relative overflow-hidden pointer-events-none">
                                            <img :src="item.img" class="absolute inset-0 w-full h-full object-cover opacity-90">
                                            <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/30 to-transparent"></div>
                                            <div class="absolute bottom-2 left-3 right-3 flex justify-between items-end z-10">
                                                <div class="flex items-center gap-2">
                                                    <span class="bg-scheme1-primary text-white font-bold text-sm px-2 py-0.5 rounded shadow-[0_0_10px_#FF7EE2]">{{ item.time }}</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div v-else class="p-3 pb-0 flex justify-between items-center mb-1 pointer-events-none">
                                            <span class="bg-scheme1-primary/20 text-scheme1-primary font-bold text-sm px-2.5 py-0.5 rounded-full border border-scheme1-primary/30 shadow-[0_0_10px_rgba(255,126,226,0.4)]">{{ item.time }}</span>
                                        </div>
                                        
                                        <div class="p-3 pt-1 relative pointer-events-none">
                                            <h4 class="font-bold text-base text-white mb-0.5 drop-shadow-md">{{ item.title }}</h4>
                                            <p class="text-xs text-scheme1-textSub/90 mb-0.5 leading-snug font-bold line-clamp-2">{{ item.desc }}</p>
                                            <div class="flex justify-between items-end mt-0.5">
                                                <p v-if="item.location" class="text-sm text-scheme1-secondary flex-1 mr-2 leading-tight">
                                                    <i class="fa-solid fa-location-dot mr-1 text-xs"></i>{{ item.location }}
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button @click="openAddModal" class="w-full py-3 mt-2 rounded-xl border-2 border-dashed border-scheme1-primary/30 text-scheme1-primary/70 hover:bg-scheme1-primary/10 hover:border-scheme1-primary hover:text-scheme1-primary transition-all font-bold flex items-center justify-center gap-2">
                                <i class="fa-solid fa-plus"></i> æ–°å¢è¡Œç¨‹
                            </button>
                        </div>
                    </div>
                </div>

                <div v-if="currentTab === 'map'" class="animate-fade-in h-full flex flex-col items-center justify-center pt-10 pb-20">
                     <div class="glass-card p-6 rounded-3xl mb-6 animate-bounce relative backdrop-blur-xl border border-scheme1-primary/40 shadow-[0_0_30px_rgba(255,126,226,0.3)]">
                         <div class="absolute inset-0 bg-scheme1-primary/10 rounded-3xl blur-xl -z-10"></div>
                        <i class="fa-solid fa-map-location-dot text-7xl text-scheme1-primary drop-shadow-[0_0_15px_rgba(255,126,226,0.6)]"></i>
                    </div>
                    <h3 class="font-bold text-2xl text-white mb-2 drop-shadow-sm text-shadow-sm font-deco tracking-widest">ğŸ—ºï¸ æ¢ç´¢ä¸Šæµ·</h3>
                    <p class="text-scheme1-textSub text-base text-center leading-relaxed font-bold">é»æ“Šè¡Œç¨‹ä¸­çš„åœ°é»<br>é–‹å•Ÿ Google Maps å°èˆª</p>
                </div>

                <div v-if="currentTab === 'shops'" class="animate-fade-in">
                    <h3 class="font-bold text-xl mb-4 pl-3 border-l-4 border-scheme1-primary text-white opacity-90 text-shadow-sm font-deco tracking-wide">ğŸ›ï¸ å¿…é€›åº—èˆ– & ç¾é£Ÿ</h3>
                     <div class="grid grid-cols-2 gap-4">
                        <div v-for="(shop, idx) in myData.shops" :key="idx" class="glass-card rounded-2xl p-4 flex flex-col items-center justify-center text-center">
                            <div :class="getShopIconColor(shop.color)" class="w-10 h-10 rounded-full bg-white/5 border border-white/20 flex items-center justify-center text-lg shadow-inner mb-2">
                                <i :class="['fa-solid', shop.icon]"></i>
                            </div>
                            <h4 class="font-bold text-white text-base leading-tight drop-shadow-sm">{{ shop.name }}</h4>
                        </div>
                     </div>
                </div>

                <div v-if="currentTab === 'hotel'" class="animate-fade-in space-y-4">
                    <h3 class="font-bold text-xl pl-3 border-l-4 border-scheme1-secondary text-white opacity-90 text-shadow-sm font-deco tracking-wide">ğŸ¨ ä½å®¿è³‡è¨Š</h3>
                    <div class="glass-card rounded-2xl p-4"><h2 class="text-xl font-bold">{{ myData.hotel.name }}</h2></div>
                </div>

            </main>

            <div class="fixed bottom-0 left-0 right-0 z-50 flex justify-center">
                <nav class="glass-nav w-full h-16 px-1 flex justify-evenly items-center rounded-t-[2rem] pb-1 relative flex-shrink-0 animate-fade-in">
                    <button @click="currentTab = 'flight'" :class="currentTab === 'flight' ? 'text-scheme1-primary' : 'text-scheme1-textSub/40'" class="flex flex-col items-center w-14 transition-colors"><i class="fa-solid fa-plane-departure text-2xl mb-0.5"></i><span class="text-[10px]">èˆªç­</span></button>
                    <button @click="currentTab = 'schedule'" :class="currentTab === 'schedule' ? 'text-scheme1-primary' : 'text-scheme1-textSub/40'" class="flex flex-col items-center w-14 transition-colors"><i class="fa-solid fa-clipboard-list text-2xl mb-0.5"></i><span class="text-[10px]">è¡Œç¨‹</span></button>
                    <div class="-mt-8 relative z-10">
                        <button @click="currentTab = 'map'" class="bg-scheme1-bg text-scheme1-primary w-14 h-14 rounded-full shadow-lg border-2 border-scheme1-primary/50 flex items-center justify-center"><i class="fa-solid fa-map text-3xl"></i></button>
                    </div>
                    <button @click="currentTab = 'shops'" :class="currentTab === 'shops' ? 'text-scheme1-primary' : 'text-scheme1-textSub/40'" class="flex flex-col items-center w-14 transition-colors"><i class="fa-solid fa-store text-2xl mb-0.5"></i><span class="text-[10px]">åº—èˆ–</span></button>
                    <button @click="currentTab = 'hotel'" :class="currentTab === 'hotel' ? 'text-scheme1-primary' : 'text-scheme1-textSub/40'" class="flex flex-col items-center w-14 transition-colors"><i class="fa-solid fa-bed text-2xl mb-0.5"></i><span class="text-[10px]">ä½å®¿</span></button>
                </nav>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, computed, watch, nextTick } = Vue;

        createApp({
            setup() {
                const currentTab = ref('schedule'); // Default to schedule to test
                const currentDayIndex = ref(0);
                const isDragging = ref(false);
                const sortableInstance = ref(null);
                const sortableList = ref(null);

                // Mock Data (Simplified for brevity)
                const myData = ref({
                    title: 'Xmas Shanghai',
                    flightOut: { from: 'HKG', to: 'PVG', airline: 'CX', no: '368', date: 'Dec 24', dep: '09:30', arr: '12:05' },
                    days: [
                        { dayNum: '24', weekday: 'TUE', date: '12.24 Day 1', events: [
                            { id: 1, time: '12:05', title: 'æŠµé”ä¸Šæµ·æµ¦æ±', desc: 'å…¥å¢ƒã€é ˜å–è¡Œæ', location: 'PVG T1' },
                            { id: 2, time: '14:00', title: 'é£¯åº— Check-in', desc: 'è¾¦ç†å…¥ä½ï¼Œæ”¾ä¸‹è¡Œæä¼‘æ¯', location: 'The Puli Hotel' },
                            { id: 3, time: '16:00', title: 'éœå®‰å¯ºæ•£æ­¥', desc: 'å‘¨é‚Šé€›è¡—ï¼Œå˜‰é‡Œä¸­å¿ƒ', location: 'JingAn Temple' },
                            { id: 4, time: '18:30', title: 'æ™šé¤ï¼šæ¦®å¯“', desc: 'ç±³å…¶æ—ä¸€æ˜Ÿæœ¬å¹«èœ', location: 'West Nanjing Rd' }
                        ]},
                        { dayNum: '25', weekday: 'WED', date: '12.25 Day 2', events: [
                            { id: 5, time: '10:00', title: 'å¤–ç˜æ•£æ­¥', desc: 'æ¬£è³è¬åœ‹å»ºç¯‰ç¾¤', location: 'The Bund' },
                            { id: 6, time: '12:30', title: 'åˆé¤ï¼šUltraviolet', desc: 'æ„Ÿå®˜é¤å»³é«”é©—', location: 'Secret Location' }
                        ]}
                    ],
                    shops: [
                        { name: 'HARMAY è©±æ¢…', icon: 'bag-shopping', color: 'gray' },
                        { name: 'Haus Shanghai', icon: 'glasses', color: 'blue' }
                    ],
                    hotel: { name: 'The Puli Hotel', engName: 'The Puli Hotel and Spa', address: '1 Changde Road, JingAn', checkIn: 'Dec 24', checkOut: 'Dec 28', image: 'https://images.unsplash.com/photo-1566073771259-6a8506099945?q=80&w=2670&auto=format&fit=crop' }
                });

                // Function to initialize SortableJS
                const initSortable = () => {
                    if (sortableInstance.value) sortableInstance.value.destroy();
                    
                    // ç¢ºä¿ DOM å·²ç¶“æ¸²æŸ“
                    nextTick(() => {
                        const el = sortableList.value;
                        if (!el) return;

                        sortableInstance.value = new Sortable(el, {
                            animation: 250,
                            delay: 300,        // é•·æŒ‰ 300ms å¾Œè§¸ç™¼
                            delayOnTouchOnly: true, // åƒ…åœ¨è§¸æ§è£ç½®å•Ÿç”¨ delay
                            ghostClass: 'sortable-ghost', // ä½”ä½ç¬¦æ¨£å¼
                            dragClass: 'sortable-drag',   // æ‹–æ›³ä¸­æ¨£å¼
                            forceFallback: true, // é—œéµï¼šå¼·åˆ¶ä½¿ç”¨ fallbackï¼Œå¯¦ç¾è„«é›¢æ–‡æª”æµçš„æ‡¸æµ®æ•ˆæœ
                            onChoose: () => {
                                // è§¸ç™¼éœ‡å‹•
                                if (navigator.vibrate) navigator.vibrate(50);
                            },
                            onStart: () => {
                                isDragging.value = true;
                                if (navigator.vibrate) navigator.vibrate(80);
                            },
                            onEnd: (evt) => {
                                isDragging.value = false;
                                // æ›´æ–°æ•¸æ“š
                                const dayEvents = myData.value.days[currentDayIndex.value].events;
                                const item = dayEvents.splice(evt.oldIndex, 1)[0];
                                dayEvents.splice(evt.newIndex, 0, item);
                            }
                        });
                    });
                };

                // Watchers to re-init sortable
                watch(currentTab, (newTab) => {
                    if (newTab === 'schedule') {
                        initSortable();
                    }
                });

                watch(currentDayIndex, () => {
                    if (currentTab.value === 'schedule') {
                        initSortable();
                    }
                });

                // Init on mount if starting on schedule tab
                Vue.onMounted(() => {
                    if (currentTab.value === 'schedule') {
                        initSortable();
                    }
                });

                // Helpers
                const getShopIconColor = (color) => {
                    const map = { gray: 'text-gray-400', blue: 'text-blue-400' };
                    return map[color] || 'text-white';
                };
                
                const openAddModal = () => {
                    alert('æ–°å¢åŠŸèƒ½å°šæœªå¯¦ä½œ');
                };

                return {
                    currentTab,
                    currentDayIndex,
                    myData,
                    sortableList,
                    isDragging,
                    getShopIconColor,
                    openAddModal
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
